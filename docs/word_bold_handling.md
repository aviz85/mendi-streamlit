# טיפול בטקסט מודגש במסמכי Word

## זיהוי הדגשות במסמך Word

### תגי XML להדגשה
- התג העיקרי להדגשת טקסט בעברית הוא `w:bCs` (Complex Script Bold)
- קיים גם תג רגיל של הדגשה (`run.bold`)
- **חשוב מאוד**: כאשר שני התגים מופיעים יחד, הם עלולים לבטל זה את זה

### המלצות לטיפול בהדגשות
1. להשתמש אך ורק בתג `w:bCs` לטקסט עברי
2. להימנע משימוש ב-`run.bold` בטקסט עברי
3. לבדוק רק את קיום התג `w:bCs` בעת קריאת המסמך

## עיטוף טקסט מודגש בתגי HTML

### כללים לעיטוף
1. יש לעטוף טקסט מודגש בתגי `<b></b>`
2. אין לעטוף רווחים ריקים בתגי הדגשה
3. יש לאחד קטעי טקסט מודגשים סמוכים לעיטוף אחד

### דוגמאות

#### לא נכון:
```html
<b>טקסט</b> <b>מודגש</b>
<b>   </b>
טקסט <b> </b> מודגש
```

#### נכון:
```html
<b>טקסט מודגש</b>
טקסט מודגש
```

## קוד לדוגמה

### קריאת טקסט מודגש
```python
# Check only for Complex Script bold (w:bCs) in XML
rPr = run._r.get_or_add_rPr()
is_bold = bool(rPr.xpath('.//w:bCs'))
```

### כתיבת טקסט מודגש
```python
# Set run direction and Complex Script bold only
rPr = run._r.get_or_add_rPr()
rPr.set('rtl', '1')
# Add w:bCs
bCs = OxmlElement('w:bCs')
rPr.append(bCs)
```

## שגיאות נפוצות לבדיקה
1. וידוא שאין שימוש כפול בתגי הדגשה
2. בדיקה שאין עיטוף של רווחים ריקים
3. בדיקה שקטעים סמוכים מאוחדים

## תהליך מומלץ לטיפול בטקסט מודגש
1. זיהוי קטעים מודגשים לפי תג `w:bCs` בלבד
2. צבירת טקסט מודגש רציף תוך התעלמות מרווחים
3. עיטוף הטקסט המצטבר בתג `<b>` אחד
4. בעת כתיבה חזרה - שימוש בתג `w:bCs` בלבד 